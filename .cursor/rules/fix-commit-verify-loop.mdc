---
description: "Fix-commit-verify loop: make fixes, commit, check production, repeat until fixed"
alwaysApply: true
---

# Fix-Commit-Verify Loop (Always Follow)

When fixing issues that affect production (www.australianrates.com), follow this loop until the problem is **definitely** fixed:

1. **Make fixes** – Apply the necessary code or config changes in the repo.
2. **Commit** – On `main`: stage changes, commit with a clear message, then push to `main`:
   - `git checkout main` (if not already on main; merge or rebase as needed)
   - `git add` relevant files
   - `git commit -m "clear message"`
   - `git push origin main`
3. **Check production** – Verify it works on https://www.australianrates.com:
   - From repo root run: `npm run test:homepage` (frontend/Pages).
   - Run `npm run test:api` and `npm run test:archive` for worker tests.
   - Use `node diagnose-api.js` if API health needs checking against production.
4. **Loop** – If any check fails, fix the cause, commit again (on main, then `git push origin main`), redeploy the affected part if needed (see deployment.mdc), then re-run checks. Do **not** stop until all checks pass.

Do not consider the task done until production verification passes. If you cannot run the production test (e.g. no network or deploy not done), say so explicitly and note that the user should run the test commands after deploy.
